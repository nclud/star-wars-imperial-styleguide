function makeElem(e){var a=document.createElement("div");return a.innerHTML=e,a.firstChild}function outerWidth(e){var a=e.offsetWidth,t=getComputedStyle(e);return a+=parseInt(t.marginLeft)+parseInt(t.marginRight)}var cacheBuster=(new Date).getTime()/1e3,$body=document.querySelector("body");$body.classList.add("imperial-styleguide-bookmarklet"),$body.appendChild(makeElem('<link rel="stylesheet" href="https://imperialstyleguide.com/css/bookmarklet.css?t='+cacheBuster+'" type="text/css" media="all"></link>')),$body.insertBefore(makeElem('<div class="neat-tv-static-screen-scan-effect"><canvas id="neat-tv-static-screen-scan-effect"></canvas></div>'),$body.firstChild);var villians=["darthvader","palpatine","stormtrooper"];document.querySelectorAll("img").forEach(function(e){var a=e.width,t=e.height;if(20<a){var o=villians[Math.floor(Math.random()*villians.length)];e.setAttribute("srcset",""),e.setAttribute("sizes",""),e.src="https://i0.wp.com/www.facetheforce.today/"+o+"?resize="+a+","+t}});var canvas=document.querySelector("#neat-tv-static-screen-scan-effect"),context=canvas.getContext("gl")||canvas.getContext("2d"),scaleFactor=2.5,samples=[],sampleIndex=0,scanOffsetY=0,scanSize=0,FPS=50,scanSpeed=15*FPS,SAMPLE_COUNT=10;function interpolate(e,a,t,o,r){return t+(e-a)/(o-a)*(r-t)}function generateRandomSample(e,a,t){for(var o=[],r=t/50,n=1-.05*Math.random(),s=[],c=0;c<Math.floor(t/r)+r;c++)s.push(Math.floor(15*Math.random()));for(c=0;c<t;c++){var i=interpolate(c/r,Math.floor(c/r),s[Math.floor(c/r)],Math.floor(c/r)+1,s[Math.floor(c/r)+1]);o.push(i)}var d=e.createImageData(a,t);for(c=0;c<a*t;c++){var l=4*c,f=Math.floor(36*Math.random());f+=o[Math.floor(c/a)],d.data[l]=d.data[1+l]=d.data[2+l]=f,d.data[3+l]=Math.round(255*n)}return d}function render(){context.putImageData(samples[Math.floor(sampleIndex)],0,0),(sampleIndex+=20/FPS)>=samples.length&&(sampleIndex=0);var e=context.createLinearGradient(0,scanOffsetY,0,scanSize+scanOffsetY);e.addColorStop(0,"rgba(255,255,255,0)"),e.addColorStop(.1,"rgba(255,255,255,0)"),e.addColorStop(.2,"rgba(255,255,255,0.2)"),e.addColorStop(.3,"rgba(255,255,255,0.0)"),e.addColorStop(.45,"rgba(255,255,255,0.1)"),e.addColorStop(.5,"rgba(255,255,255,1.0)"),e.addColorStop(.55,"rgba(255,255,255,0.55)"),e.addColorStop(.6,"rgba(255,255,255,0.25)"),e.addColorStop(1,"rgba(255,255,255,0)"),context.fillStyle=e,context.fillRect(0,scanOffsetY,canvas.width,scanSize+scanOffsetY),context.globalCompositeOperation="lighter",(scanOffsetY+=canvas.height/scanSpeed)>canvas.height&&(scanOffsetY=-scanSize/2),window.requestAnimationFrame(render)}window.onresize=function(){canvas.width=canvas.offsetWidth/scaleFactor,canvas.height=canvas.width/(canvas.offsetWidth/canvas.offsetHeight),scanSize=canvas.offsetHeight/scaleFactor/3,samples=[];for(var e=0;e<SAMPLE_COUNT;e++)samples.push(generateRandomSample(context,canvas.width,canvas.height))},window.onresize(),window.requestAnimationFrame(render);